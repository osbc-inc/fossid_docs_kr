---
description: 23.1 이전 버전을 사용 중이라면, 해당 가이드를 참고하세요.
---

# 업데이트 가이드(23.1 버전 미만)

## Workbench Server 업데이트 지침

![](https://fossid.osbc.co.kr/help/en/images/security.svg)

### \[전제 조건] <a href="#assumptions" id="assumptions"></a>

* 이번 업그레이드의 대상 버전은 <mark style="color:red;">**2025.1.0**</mark>입니다.
* 현재 설치된 FossID Workbench 버전은 22.2.x 이상입니다.\
  더 이전 버전에서 업그레이드하려면 먼저 22.2.x로 업그레이드 해야합니다.
* 기존 Workbench는 /fossid 경로에 설치되어 있습니다.
* 데이터베이스의 permissions 및 role\_permission 테이블은 수정되지 않았습니다.&#x20;



### \[OS 요구사항]

* Debian 11
* Debian 12
* Ubuntu 20.04
* Ubuntu 22.04
* Ubuntu 24.04
* RedHat Enterprise Linux 8 and 9
* RedHat Enterprise Linux Server 8 and 9

### \[PHP 요구사항]

* PHP의 최소 요구 버전은 <mark style="color:red;">**8.2**</mark>입니다.
* 단, 모든 하위 시스템(PHP, DB 등)은 **유지보수 중인 가장 오래된 버전 이상**을 사용하는 것을 권장합니다.

### \[DATABASE 요구사항]

* Database 서버의 최소 요구 버전은 <mark style="color:red;">**MySQL Server 8.0**</mark> <mark style="color:red;"></mark><mark style="color:red;">또는</mark> <mark style="color:red;"></mark><mark style="color:red;">**MariaDB 10.6**</mark>입니다.
* 단, 모든 하위 시스템(PHP, DB 등)은 **유지보수 중인 가장 오래된 버전 이상**을 사용하는 것을 권장합니다.







### \[패키지 설치]

* FossID 설치 파일에 접근하기 위한 정보는 **delivery 메일**에 포함되어 있습니다.
* 패키지를 설치하세요.
  *   DEB 기반 \


      ```
      sudo apt install ./fossid-release_regular_amd64-{VERSION}.deb -y
      sudo systemctl restart php$(php -r 'echo PHP_MAJOR_VERSION.".".PHP_MINOR_VERSION;')-fpm.service
      ```
  *   RPM 기반 \


      ```
      sudo yum localinstall ./fossid-release_regular.x86_64-{VERSION}.rpm -y
      ```

      \

* #### fossid.conf 업데이트 <a href="#update-fossidconf" id="update-fossidconf"></a>
  * **FossID Workbench 21.2 버전부터는**, `fossid.conf` 설정을 새 템플릿으로 **마이그레이션(이전)** 할 **필요가 없고**, **권장되지도 않습니다**.\
    기존의 **21.2 이전 버전 설정 파일**로도 Workbench는 **정상적으로 작동**합니다.
    *   **어떤 이유로도 설정을 새 템플릿으로 마이그레이션**하고 싶다면, 아래와 같이 하면 됩니다:



        1\)현재 사용 중인 `/fossid/etc/fossid.conf` 설정 파일을 백업해 둡니다. 예를 들어 `fossid.conf_bak` 같은 이름으로 복사해 보관합니다.\


        2\)기본으로 제공되는 새 설정 템플릿 파일(`/fossid/etc/fossid.conf.dist`)의 이름을 기존 설정 파일 이름(`/fossid/etc/fossid.conf`)으로 변경합니다.\


        3\)새로 적용된 설정 파일의 내용을 이전에 백업해둔 설정 파일(`fossid.conf_bak`)을 참고하여, 원래 사용하던 설정값들이 반영되도록 수정합니다.



*   Workbench URL 구성

    *   이 정보는 이메일 내에 올바른 절대 URL을 생성하는 데 사용됩니다:

        ```
        webapp_base_url = https://mycompany.com/index.php
        ```

        \
        설정을 완료한 후 `fossid.conf` 파일을 저장하세요.

        참고: 설정 변경 사항은 즉시 적용되며, 서버를 재시작할 필요는 없습니다.

    \




### \[설치 후 작업]

*   DATABASE 업데이트

    *   버전 22.2부터 중복 데이터를 방지하기 위해 데이터베이스 수준에서 새로운 고유 제약 조건(unique constraints)이 추가되었습니다. 기존 중복 데이터를 식별하고 해결하기 위해, 다음 명령어를 `/fossid/webapp` 디렉터리에서 실행해야 합니다:\


        <pre><code><strong>cd /fossid/webapp
        </strong></code></pre>



    * 이 명령어는 **대화형 CLI**를 실행하여 중복된 라이선스나 컴포넌트가 있다면 하나의 항목에 식별 정보를 재할당하고 나머지는 삭제함으로써(식별 정보는 손실되지 않음) 중복을 해결합니다. \
      프로젝트/스캔/사용자 중복은 접미사를 추가하여 중복된 항목을 해결합니다.
    *   <pre><code><strong>sudo -u www-data php bin/console.php enforce_data_integrity
        </strong></code></pre>

        *   중복이 있는 경우

            ```
            The system checks if there is a duplicates in DataBase tables: 
            'licenses'; 
            'projects'; 
            'components'; 
            'scans'; 
            'users'; 
            ----------------------- 
            The system didn't find duplicates. Do you want to add UNIQUE CONSTRAINTS to the tables? (defaults to yes)
              [0] yes
              [1] no
              > 0
            ```

        &#x20;      \
        \
        \*   발견된 중복을 수정하려면 대화형 CLI에 표시되는 지침을 따르세요.\
        마지막 단계는 해당 테이블에 고유 제약 조건을 추가하는 것입니다. \
        고유 키가 이미 존재하는 경우,  다음과 같은오류 메시지가 나타날 수 있습니다:\


        ```
        The system didn't find duplicates. Do you want to add UNIQUE CONSTRAINTS to the tables? (defaults to yes)
          [0] yes
          [1] no
         > 0
        The system tries to add UNIQUE CONSTRAINT 'uc_identifier' to table: 'licenses' on column: `identifier`.
        SQLSTATE[42000]: Syntax error or access violation: 1061 Duplicate key name 'uc_identifier'
        ```

        \
        → 이미 고유 키가 존재하므로 추가 작업은 필요하지 않습니다.\
        \
        \


        *   중복이 없는 경우&#x20;

            ```
            "The system found duplicates in the next tables:"
            'projects'
            'licenses'
            ----------------------- 
            Do you want to clean duplicates? (defaults to yes)
              [0] yes
              [1] no
             > 0
            ```



    *   다음 표와 열은 데이터의 고유성을 확인하는 데 사용됩니다:

        ```
          Table       unique by    Column(s)
         'projects'                'project_code' 
         'licenses'                'identifier' 
         'components'              'name' and  'version' 
         'scans'                   'code', 
         'users'                   'username'  
        ```





*   릴리스 20.1 이전에 만들어진 컴포넌트 식별을 마이그레이션하려면 한 번만 작업을 수행해야 합니다:

    * 릴리스 20.1 이전에는 식별된 파일당 하나의 컴포넌트만 식별자로 할당할 수 있었습니다.
    *   아래 명령을 한 번 실행하면 "identifications" 테이블의 "component\_id" 열에 있는 이전 구성 요소 식별을 "identification\_component" 테이블로 마이그레이션할 수 있습니다.\


        ```
        sudo -u www-data php bin/console.php migrate_legacy_identifications --auto_migrate
        ```

        \
        "identifications.component\_id" 열은 24.3 릴리스에서 dbupdate.php 스크립트에 의해 제거되었습니다.\



* <mark style="color:red;">**23.1.x 이전 버전에서 업데이트하는 경우, 필수로 이 작업이 필요합니다.**</mark>
  * ```
    sudo -u www-data php bin/console.php split_file_client_results
    ```

&#x20;             file\_client\_results 테이블은 스캔당 하나의 테이블로 분할됩니다.\
&#x20;             이렇게 하면 스캔이 삭제될 때 삭제된 스캔과 연결된 file\_client\_results\_x 테이블을 삭제하여 \
&#x20;              MySQL에서 디스크 공간을 즉시 확보함으로써 데이터베이스 유지 관리가 용이해집니다.

&#x20;              file\_client\_results\_SCAN\_ID와 같은 이름의 테이블이 생성되었는지 확인하시기 바랍니다.

&#x20;              초기 테이블 file\_client\_results는 old\_file\_client\_results라는 이름으로 여전히 존재하며, \
&#x20;              새 테이블이 생성되고 데이터가 마이그레이션되었는지 확인한 후 수동으로 삭제할 수 있습니다.

&#x20;              중복을 수정하고 split\_file\_client\_results 명령을 실행한 후 정기적인 업그레이드 프로세스를 \
&#x20;             계속 진행합니다.\
\
\
\


* 아래 쿼리를 통해 모든 테이블에서 row\_format이 DYNAMIC 또는 COMPRESSED로 설정되어 있는지 확인하며, 그렇지 않은 경우 아래 ALTER TABLE 문을 사용하여 수동으로 변경해야 합니다.
  *   <pre><code><strong>mysql
      </strong><strong>use fossid_db;
      </strong><strong>
      </strong><strong>mysql > SELECT table_name, row_format FROM information_schema.tables WHERE table_schema=DATABASE();
      </strong></code></pre>

      * 각 테이블에서 row\_format이 DYNAMIC 또는 COMPRESSED로 설정되어 있는지 확인합니다:

      <figure><img src="../../.gitbook/assets/image (242).png" alt=""><figcaption></figcaption></figure>

      *   필요한 경우 테이블을 수동으로 수정하는 방법 예시 (`row_format`을 `DYNAMIC`으로 설정):

          ```
          ALTER TABLE [table_name] ROW_FORMAT=DYNAMIC;
          ```

          \






      \
































