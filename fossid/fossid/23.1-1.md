---
description: 23.1 이상 버전을 사용 중이라면, 해당 가이드를 참고하세요.
---

# 업데이트 가이드(23.1 버전 이상)

## Workbench Server 업데이트 지침

![](https://fossid.osbc.co.kr/help/en/images/security.svg)

### \[전제 조건] <a href="#assumptions" id="assumptions"></a>

* 이번 업그레이드의 대상 버전은 <mark style="color:red;">**2025.1.0**</mark>입니다.
* 현재 설치된 FossID Workbench 버전은 22.2.x 이상입니다.\
  더 이전 버전에서 업그레이드하려면 먼저 22.2.x로 업그레이드 해야합니다.
* 기존 Workbench는 /fossid 경로에 설치되어 있습니다.
* 데이터베이스의 permissions 및 role\_permission 테이블은 수정되지 않았습니다.&#x20;



### \[OS 요구사항]

* Debian 11
* Debian 12
* Ubuntu 20.04
* Ubuntu 22.04
* Ubuntu 24.04
* RedHat Enterprise Linux 8 and 9
* RedHat Enterprise Linux Server 8 and 9

### \[PHP 요구사항]

* PHP의 최소 요구 버전은 <mark style="color:red;">**8.2**</mark>입니다.
* 단, 모든 하위 시스템(PHP, DB 등)은 **유지보수 중인 가장 오래된 버전 이상**을 사용하는 것을 권장합니다.

### \[DATABASE 요구사항]

* Database 서버의 최소 요구 버전은 <mark style="color:red;">**MySQL Server 8.0**</mark> <mark style="color:red;"></mark><mark style="color:red;">또는</mark> <mark style="color:red;"></mark><mark style="color:red;">**MariaDB 10.6**</mark>입니다.
* 단, 모든 하위 시스템(PHP, DB 등)은 **유지보수 중인 가장 오래된 버전 이상**을 사용하는 것을 권장합니다.







### \[패키지 설치]

* FossID 설치 파일에 접근하기 위한 정보는 **delivery 메일**에 포함되어 있습니다.
* 패키지를 설치하세요.
  *   DEB 기반 \


      ```
      sudo apt install ./fossid-release_regular_amd64-{VERSION}.deb -y
      sudo systemctl restart php$(php -r 'echo PHP_MAJOR_VERSION.".".PHP_MINOR_VERSION;')-fpm.service
      ```
  *   RPM 기반 \


      ```
      sudo yum localinstall ./fossid-release_regular.x86_64-{VERSION}.rpm -y
      ```

      \

* #### fossid.conf 업데이트 <a href="#update-fossidconf" id="update-fossidconf"></a>
  * **FossID Workbench 21.2 버전부터는**, `fossid.conf` 설정을 새 템플릿으로 **마이그레이션(이전)** 할 **필요가 없고**, **권장되지도 않습니다**.\
    기존의 **21.2 이전 버전 설정 파일**로도 Workbench는 **정상적으로 작동**합니다.
    *   **어떤 이유로도 설정을 새 템플릿으로 마이그레이션**하고 싶다면, 아래와 같이 하면 됩니다:



        1\)현재 사용 중인 `/fossid/etc/fossid.conf` 설정 파일을 백업해 둡니다. 예를 들어 `fossid.conf_bak` 같은 이름으로 복사해 보관합니다.\


        2\)기본으로 제공되는 새 설정 템플릿 파일(`/fossid/etc/fossid.conf.dist`)의 이름을 기존 설정 파일 이름(`/fossid/etc/fossid.conf`)으로 변경합니다.\


        3\)새로 적용된 설정 파일의 내용을 이전에 백업해둔 설정 파일(`fossid.conf_bak`)을 참고하여, 원래 사용하던 설정값들이 반영되도록 수정합니다.



*   Workbench URL 구성

    *   이 정보는 이메일 내에 올바른 절대 URL을 생성하는 데 사용됩니다:

        ```
        webapp_base_url = https://mycompany.com/index.php
        ```

        \
        설정을 완료한 후 `fossid.conf` 파일을 저장하세요.

        참고: 설정 변경 사항은 즉시 적용되며, 서버를 재시작할 필요는 없습니다.

    \




### \[설치 후 작업]

*   DATABASE 업데이트

    * 버전 22.2부터 중복 데이터를 방지하기 위해 데이터베이스 수준에서 새로운 고유 제약 조건(unique constraints)이 추가되었습니다. 기존 중복 데이터를 식별하고 해결하기 위해, 다음 명령어를 `/fossid/webapp` 디렉터리에서 실행해야 합니다:
    *   릴리스 20.1 이전에 만들어진 컴포넌트 식별을 마이그레이션하려면 한 번만 작업을 수행해야 합니다:\


        <pre><code><strong>cd /fossid/webapp
        </strong></code></pre>



    * 이 명령어는 **대화형 CLI**를 실행하여 중복된 라이선스나 컴포넌트가 있다면 하나의 항목에 식별 정보를 재할당하고 나머지는 삭제함으로써(식별 정보는 손실되지 않음) 중복을 해결합니다. \
      프로젝트/스캔/사용자 중복은 접미사를 추가하여 중복된 항목을 해결합니다.
    *   <pre><code><strong>sudo -u www-data php bin/console.php enforce_data_integrity
        </strong></code></pre>

        *   중복이 있는 경우

            ```
            The system checks if there is a duplicates in DataBase tables: 
            'licenses'; 
            'projects'; 
            'components'; 
            'scans'; 
            'users'; 
            ----------------------- 
            The system didn't find duplicates. Do you want to add UNIQUE CONSTRAINTS to the tables? (defaults to yes)
              [0] yes
              [1] no
              > 0
            ```

        &#x20;      \
        \
        \*   발견된 중복을 수정하려면 대화형 CLI에 표시되는 지침을 따르세요.\
        마지막 단계는 해당 테이블에 고유 제약 조건을 추가하는 것입니다. \
        고유 키가 이미 존재하는 경우,  다음과 같은오류 메시지가 나타날 수 있습니다:\


        ```
        The system didn't find duplicates. Do you want to add UNIQUE CONSTRAINTS to the tables? (defaults to yes)
          [0] yes
          [1] no
         > 0
        The system tries to add UNIQUE CONSTRAINT 'uc_identifier' to table: 'licenses' on column: `identifier`.
        SQLSTATE[42000]: Syntax error or access violation: 1061 Duplicate key name 'uc_identifier'
        ```

        \
        → 이미 고유 키가 존재하므로 추가 작업은 필요하지 않습니다.\
        \
        \


        *   중복이 없는 경우&#x20;

            ```
            "The system found duplicates in the next tables:"
            'projects'
            'licenses'
            ----------------------- 
            Do you want to clean duplicates? (defaults to yes)
              [0] yes
              [1] no
             > 0
            ```



    * 다음 표와 열은 데이터의 고유성을 확인하는 데 사용됩니다:

    ```
      Table       unique by    Column(s)
     'projects'                'project_code' 
     'licenses'                'identifier' 
     'components'              'name' and  'version' 
     'scans'                   'code', 
     'users'                   'username'  
    ```





* 릴리스 20.1 이전에 만들어진 컴포넌트 식별을 마이그레이션하려면 한 번만 작업을 수행해야 합니다:
  * 릴리스 20.1 이전에는 식별된 파일당 하나의 컴포넌트만 식별자로 할당할 수 있었습니다.
  *   아래 명령을 한 번 실행하면 "identifications" 테이블의 "component\_id" 열에 있는 이전 구성 요소 식별을 "identification\_component" 테이블로 마이그레이션할 수 있습니다.\


      ```
      sudo -u www-data php bin/console.php migrate_legacy_identifications --auto_migrate
      ```

      \
      "identifications.component\_id" 열은 24.3 릴리스에서 dbupdate.php 스크립트에 의해 제거되었습니다.\




* 아래 쿼리를 통해 모든 테이블에서 row\_format이 DYNAMIC 또는 COMPRESSED로 설정되어 있는지 확인하며, 그렇지 않은 경우 아래 ALTER TABLE 문을 사용하여 수동으로 변경해야 합니다.
  *   <pre><code><strong>mysql
      </strong><strong>use fossid_db;
      </strong><strong>
      </strong><strong>mysql > SELECT table_name, row_format FROM information_schema.tables WHERE table_schema=DATABASE();
      </strong></code></pre>

      * 각 테이블에서 row\_format이 DYNAMIC 또는 COMPRESSED로 설정되어 있는지 확인합니다:

      <figure><img src="../../.gitbook/assets/image (242).png" alt=""><figcaption></figcaption></figure>

      *   필요한 경우 테이블을 수동으로 수정하는 방법 예시 (`row_format`을 `DYNAMIC`으로 설정):

          ```
          ALTER TABLE [table_name] ROW_FORMAT=DYNAMIC;
          ```

          \






      \
























\------



Ubuntu 20.04 / 22.04:

```
sudo add-apt-repository ppa:ondrej/php -y
sudo apt update
sudo apt remove php7\*
sudo apt remove php8.0\*
```

Debian 11:

```
sudo apt update
sudo apt install lsb-release apt-transport-https ca-certificates -y
sudo wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg
echo "deb https://packages.sury.org/php/ $(lsb_release -sc) main" | sudo tee /etc/apt/sources.list.d/php8.2.list
sudo apt update
sudo apt remove php7\*
sudo apt remove php8.0\*
```

RedHat 8/9:

```
#저장소 추가 (RedHat 8 기준작성)
sudo yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm -y
sudo yum install -y https://rpms.remirepo.net/enterprise/remi-release-8.rpm
sudo yum module reset php
sudo yum module enable php:remi-8.2 -y
sudo yum install php-cli php-fpm php-process mariadb-server mariadb php-mysqlnd php-zip php-xml php-curl php-ldap php-mbstring php-intl vim libxslt unzip java-11-openjdk-headless git p7zip p7zip-plugins perl -y

```

\




\[MYSQL 요구사항]

* 최소 MySQL 8.0 또는 MariaDB 10.6



***



1. 패키지 설치

* DEB 설치 (Debian/Ubuntu 계열)
  * `fossid-release_regular_amd64-{버전}.deb` 파일을 설치합니다.
  * 설치 후, 현재 설치된 PHP 메이저.마이너 버전(예: 8.2)에 맞춰 php-fpm 서비스를 재시작합니다.

```
sudo apt install ./fossid-release_regular_amd64-{VERSION}.deb -y
sudo systemctl restart php$(php -r 'echo PHP_MAJOR_VERSION.".".PHP_MINOR_VERSION;')-fpm.service
```

* RPM 설치 (RHEL)
  * `fossid-release_regular.x86_64-{버전}.rpm` 파일을 로컬에서 설치합니다.

```
sudo yum localinstall ./fossid-release_regular.x86_64-{VERSION}.rpm -y
```





2. 데이터베이스 설정&#x20;

* 설치 폴더로 이동&#x20;

```
cd /fossid/setup/database
```

* 인덱스 설정 및 데이터베이스 구조 확인

```
sudo -u www-data php dbupdate.php /fossid/etc/fossid.conf
```

* 필요한 모든 데이터(역할 및 권한 등)가 있는지 확인하고 이전 역할/권한을 제거합니다.

```
sudo -u www-data php db_info_update.php /fossid/etc/fossid.conf
```

* 라이선스 데이터베이스 업데이트

```
sudo -u www-data php licenseupdate.php --no-update --no-disable /fossid/etc/fossid.conf
```

\*인수에 주의하세요. `--no-update`및 `--no-disable`는 선택 사항입니다.

`--no-update`: 기본 데이터베이스에 포함된 라이선스의 라이선스 텍스트를 편집했고 해당 편집 내용을 유지하려면 이 인수를 사용하세요. 이 인수를 사용해도 잘못된 라이선스 식별자가 수정되는 것을 막을 수는 없습니다. --no-fix-idents를 참조하세요.\
`--no-disable`: 기본 데이터베이스에 포함되지 않은 라이선스를 수동으로 추가했고 이러한 라이선스로 파일을 계속 식별하려는 경우 또는 SPDX 표준에 따라 더 이상 사용되지 않는 것으로 표시된 식별자로 파일을 계속 식별하려는 경우 이 인수를 사용합니다.

`--no-fix-idents`: –no-fix-idents 옵션은 이 유틸리티가 데이터베이스에서 발견된 잘못된 식별자나 오래된 식별자를 업데이트하지 않도록 합니다. 이미 존재하는 일부 라이선스가 다시 삽입될 수 있으므로 –no-insert 옵션을 함께 사용하지 않는 한 이 옵션을 활성화하지 않는 것이 좋습니다.

`--dry-run`: 어떠한 수정도 하지 말고, 단지 무엇이 수행될 것인지 보여주세요.

























